<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE GRAND CHESS - Art of Strategy</title>
    
    <!-- 1. LIBRARIES -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>

    <style>
        /* 2. AESTHETICS & FONTS */
        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&family=Inter:wght@200;300;400;500&display=swap');
        
        :root {
            --bg-dark: #050505;
            --text-main: #e5e5e5;
            --text-muted: #888888;
            --accent: #d4af37; /* Gold */
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }

        .font-serif { font-family: 'Cormorant Garamond', serif; }
        .font-sans { font-family: 'Inter', sans-serif; }

        /* Animations */
        @keyframes spin-slow { from { transform: translate(-50%, -50%) rotate(0deg); } to { transform: translate(-50%, -50%) rotate(360deg); } }
        @keyframes spin-reverse { from { transform: translate(-50%, -50%) rotate(360deg); } to { transform: translate(-50%, -50%) rotate(0deg); } }
        @keyframes fade-up { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse-glow { 0%, 100% { box-shadow: 0 0 20px rgba(255,255,255,0.05); } 50% { box-shadow: 0 0 40px rgba(255,255,255,0.1); } }
        
        /* New: Dash Offset Animation for Ellipse Path */
        @keyframes dash-rotate {
            from { stroke-dashoffset: 0; }
            to { stroke-dashoffset: 1000; } 
        }

        .animate-spin-slow { animation: spin-slow 80s linear infinite; }
        .animate-spin-reverse { animation: spin-reverse 120s linear infinite; }
        .animate-pulse-glow { animation: pulse-glow 4s infinite ease-in-out; }
        
        /* Apply dash animation */
        .animate-dash-flow { animation: dash-rotate 100s linear infinite; }
        
        /* Fade In Logic */
        .fade-in-section { opacity: 0; transform: translateY(30px); transition: opacity 1s ease-out, transform 1s ease-out; }
        .fade-in-section.is-visible { opacity: 1; transform: translateY(0); }

        .fade-in-up { animation: fade-up 1s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; opacity: 0; }
        .delay-100 { animation-delay: 0.2s; }
        .delay-200 { animation-delay: 0.4s; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

        /* 3. CHESSBOARD CUSTOMIZATION */
        .board-container {
            box-shadow: 0 20px 50px rgba(0,0,0,0.7);
            border: 1px solid rgba(255,255,255,0.1);
            transition: transform 0.5s ease;
        }
        
        .white-1e1d7 { background-color: #2a2a2a; color: #b0b0b0; }
        .black-3c85d { background-color: #111; color: #444; }
        .piece-417db { filter: drop-shadow(0 4px 6px rgba(0,0,0,0.5)); transition: transform 0.2s; }
        .piece-417db:hover { transform: scale(1.1); cursor: pointer; } 
        .highlight-move { box-shadow: inset 0 0 0 3px rgba(212, 175, 55, 0.5); }

        /* Click Move Highlights */
        .highlight-dot {
            background: radial-gradient(circle, rgba(212, 175, 55, 0.5) 18%, transparent 20%);
        }
        .highlight-ring {
            box-shadow: inset 0 0 0 4px rgba(212, 175, 55, 0.5);
        }
        .highlight-selected {
            background-color: rgba(255, 255, 255, 0.2) !important;
        }

        /* Carousel Styles */
        .carousel-container {
            perspective: 1000px;
            overflow: hidden;
        }
        .carousel-track {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        .carousel-slide {
            min-width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.5s ease-in-out;
        }
        .carousel-slide.active {
            opacity: 1;
            transform: scale(1);
        }

        /* Dropdown Menu Transition */
        #dropdown-menu {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, opacity 0.4s ease-out;
        }
        #dropdown-menu.visible {
            max-height: 400px; 
            opacity: 1;
        }

        /* Intro Screen - Cinematic */
        #intro-overlay {
            transition: opacity 2s ease-out, visibility 2s ease-out; 
        }
        #intro-overlay.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
        .intro-board {
            box-shadow: 0 0 100px rgba(0,0,0,0.8);
            border: 2px solid rgba(255,255,255,0.1);
        }
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        .shake-effect {
            animation: shake 0.5s; 
            animation-iteration-count: 1; 
        }
        
        /* Checkmate Text Animation - Absolute Center */
        .checkmate-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            pointer-events: none;
        }
        .checkmate-text {
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .checkmate-text.visible {
            opacity: 1;
            transform: scale(1);
        }
    </style>
</head>
<body class="overflow-hidden" id="main-body"> 

    <!-- CINEMATIC INTRO OVERLAY -->
    <div id="intro-overlay" class="fixed inset-0 z-[9999] bg-black flex flex-col items-center justify-center">
        
        <!-- Intro Board Container (No Transform Scale to fix animations) -->
        <!-- Increased width/height directly in classes -->
        <div id="intro-board-container" class="relative mb-0 transition-all duration-1000">
            <div id="introBoard" class="w-[380px] h-[380px] md:w-[500px] md:h-[500px] intro-board transition-opacity duration-1000"></div>
        </div>
        
        <!-- Checkmate Overlay Text (Global Center) -->
        <div class="checkmate-container">
            <div id="checkmate-announcement" class="checkmate-text text-center">
                <h1 class="text-4xl md:text-6xl font-serif text-[#d4af37] font-bold drop-shadow-[0_0_50px_rgba(0,0,0,1)] stroke-black tracking-widest bg-black/80 p-8 backdrop-blur-md rounded-lg border border-[#d4af37]/30 inline-block shadow-2xl" style="-webkit-text-stroke: 1px black;">CHECKMATE</h1>
            </div>
        </div>

        <div class="absolute bottom-12 right-12 z-50">
            <button onclick="skipIntro()" class="text-xs text-white/30 hover:text-white tracking-[0.2em] uppercase border-b border-transparent hover:border-white transition-all pb-1">
                Skip Intro
            </button>
        </div>
        
        <div class="absolute inset-0 pointer-events-none opacity-20 z-0">
            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] border border-white/5 rounded-full animate-spin-slow"></div>
        </div>
    </div>

    <!-- FIXED SPOTLIGHT OVERLAY -->
    <div class="fixed top-0 left-0 w-full h-full pointer-events-none z-40 overflow-hidden mix-blend-screen">
        <div class="absolute top-[-150px] left-1/2 -translate-x-1/2 w-[800px] h-[600px] bg-[radial-gradient(circle,rgba(255,255,255,0.25)_0%,rgba(255,255,255,0)_70%)] blur-[80px]"></div>
        <div class="absolute top-[-20%] left-1/2 -translate-x-1/2 w-[60%] h-[120%] bg-gradient-to-b from-white/10 to-transparent blur-3xl rounded-full opacity-60"></div>
    </div>

    <!-- NAV BAR -->
    <nav class="fixed top-0 w-full z-50 px-6 py-6 mix-blend-difference text-white flex justify-between items-start">
        
        <!-- Left: Menu -->
        <div class="relative">
            <div onclick="toggleDropdown()" class="text-xs tracking-[0.3em] font-sans opacity-70 hover:opacity-100 cursor-pointer flex items-center gap-2 group z-50 relative">
                <span>MENU</span>
                <span id="menu-icon" class="transition-transform duration-300 group-hover:rotate-90"><i data-lucide="plus" width="16" height="16"></i></span>
            </div>

            <div id="dropdown-menu" class="absolute top-full left-0 mt-4 w-48 flex flex-col gap-2 bg-black/80 backdrop-blur-sm border border-white/10 p-4 rounded-sm shadow-2xl">
                <a href="#hero-section" onclick="toggleDropdown(); scrollToSection('hero-section')" class="text-xs tracking-[0.2em] text-white/60 hover:text-[#d4af37] hover:pl-2 transition-all block py-1 border-b border-white/5">HOME</a>
                <a href="#intro-section" onclick="toggleDropdown(); scrollToSection('intro-section')" class="text-xs tracking-[0.2em] text-white/60 hover:text-[#d4af37] hover:pl-2 transition-all block py-1 border-b border-white/5">HISTORY</a>
                <a href="#rules-section" onclick="toggleDropdown(); scrollToSection('rules-section')" class="text-xs tracking-[0.2em] text-white/60 hover:text-[#d4af37] hover:pl-2 transition-all block py-1 border-b border-white/5">RULES</a>
                <a href="#pieces-section" onclick="toggleDropdown(); scrollToSection('pieces-section')" class="text-xs tracking-[0.2em] text-white/60 hover:text-[#d4af37] hover:pl-2 transition-all block py-1 border-b border-white/5">PIECES</a>
                <a href="#info-section" onclick="toggleDropdown(); scrollToSection('info-section')" class="text-xs tracking-[0.2em] text-white/60 hover:text-[#d4af37] hover:pl-2 transition-all block py-1 border-b border-white/5">KNOWLEDGE</a>
                <a href="#game-section" onclick="toggleDropdown(); scrollToSection('game-section')" class="text-xs tracking-[0.2em] text-white/60 hover:text-[#d4af37] hover:pl-2 transition-all block py-1">GAME</a>
            </div>
        </div>

        <!-- Center: Title -->
        <div class="absolute left-1/2 -translate-x-1/2 text-center top-6 pointer-events-none">
            <h1 class="text-2xl font-serif tracking-widest font-bold">CHESS</h1>
            <div class="text-[0.6rem] tracking-[0.4em] text-white/50 mt-1 uppercase">Grandmaster Edition</div>
        </div>

        <!-- Right: CTA -->
        <button onclick="scrollToSection('game-section')" class="text-xs tracking-[0.2em] border border-white/30 px-4 py-2 hover:bg-white hover:text-black transition-all">
            PLAY NOW
        </button>
    </nav>

    <!-- SECTION 1: HERO -->
    <section id="hero-section" class="relative w-full h-screen flex flex-col justify-center items-center overflow-hidden bg-[#0a0a0a]">
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[300px] h-[300px] md:w-[500px] md:h-[500px] bg-[#1a1a1a] rounded-full shadow-2xl z-0 animate-pulse-glow border border-white/5"></div>
        <div class="absolute inset-0 pointer-events-none z-0">
            <div class="absolute top-1/2 left-1/2 w-[340px] h-[340px] md:w-[580px] md:h-[580px] border border-dashed border-white/20 rounded-full animate-spin-slow"></div>
            <div class="absolute top-1/2 left-1/2 w-[450px] h-[450px] md:w-[750px] md:h-[750px] border border-dotted border-white/10 rounded-full animate-spin-reverse" style="animation-duration: 120s;"></div>
            <div class="absolute top-1/2 left-1/2 w-[600px] h-[600px] md:w-[1100px] md:h-[1100px] border border-dashed border-white/5 rounded-full animate-spin-slow" style="animation-duration: 180s;"></div>
        </div>
        <div class="z-20 text-center max-w-4xl px-4 relative">
            <h2 class="text-6xl md:text-9xl font-serif leading-none mb-8 fade-in-up text-white mix-blend-screen drop-shadow-[0_0_15px_rgba(255,255,255,0.1)]">Timeless <br/> <span class="italic text-white/50">Masterpiece</span></h2>
            <p class="text-white/70 text-lg md:text-xl font-serif max-w-xl mx-auto mb-12 fade-in-up delay-100 leading-relaxed tracking-wide">64개의 격자 위에서 펼쳐지는 무한한 가능성.<br/>인류 역사상 가장 오래되고 고귀한 지적 유희를 탐구하십시오.</p>
            <div class="fade-in-up delay-200">
                <button onclick="scrollToSection('intro-section')" class="group relative px-10 py-4 bg-transparent border border-white/30 text-white font-sans text-xs tracking-[0.3em] uppercase overflow-hidden hover:bg-white hover:text-black transition-all duration-500"><span class="relative z-10">start</span></button>
            </div>
        </div>
        <div class="absolute bottom-12 left-1/2 -translate-x-1/2 opacity-30 animate-bounce cursor-pointer z-20" onclick="scrollToSection('intro-section')"><i data-lucide="arrow-down" width="24"></i></div>
    </section>

    <!-- SECTION 2: HISTORY -->
    <section id="intro-section" class="relative bg-[#0a0a0a] overflow-hidden flex justify-center items-center py-40 min-h-[150vh]">
        <div class="absolute top-40 left-[10%] w-24 h-24 border border-white/5 rotate-12 animate-pulse-glow z-0"></div>
        <div class="absolute bottom-60 right-[15%] w-32 h-32 border border-white/5 -rotate-6 animate-pulse-glow" style="animation-delay: 1.5s;"></div>
        <div class="relative w-[94vw] aspect-square md:w-[90vw] max-w-[1300px] bg-[#111] rounded-full border border-white/5 shadow-[0_0_150px_rgba(0,0,0,0.8)] flex flex-col items-center justify-start pt-[10%] px-6 text-center z-10 shrink-0">
            <svg id="scroll-ring" class="absolute inset-0 w-full h-full pointer-events-none z-10" viewBox="0 0 200 200"><circle cx="100" cy="100" r="98" fill="none" stroke="rgba(255,255,255,0.4)" stroke-width="4" stroke-dasharray="140 168" stroke-dashoffset="70" stroke-linecap="butt" transform="rotate(-90 100 100)" /></svg>
            <div class="absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.03)_0%,_transparent_70%)] pointer-events-none rounded-full"></div>
            <div class="max-w-4xl mx-auto fade-in-section relative z-20 flex flex-col items-center">
                <span class="block text-[#d4af37] text-xs tracking-[0.5em] mb-8 uppercase font-sans">The Origins</span>
                <h3 class="text-3xl md:text-5xl font-serif text-white/90 mb-10 leading-tight">"A Journey Through <span class="italic text-white/40">Time</span>."</h3>
                <div class="w-16 h-[1px] bg-white/30 mx-auto mb-10"></div>
                <p class="text-white/60 font-serif text-base md:text-xl leading-relaxed max-w-3xl mx-auto tracking-wide break-keep mb-16">6세기 인도 굽타 왕조의 '차투랑가'에서 시작된 체스는 페르시아의 '샤트란지'를 거쳐, 15세기 남유럽에서 비로소 여왕(Queen)이 전장을 지배하는 현대적 모습을 갖추었습니다. <br/><br/>천 년의 시간을 넘어 왕좌를 지키기 위해 진화해 온 이 침묵의 전쟁은 단순한 놀이가 아닌, 인류 지성사의 축소판입니다.</p>
                <!-- CHESS PIECES DISPLAY -->
                <div class="flex flex-wrap justify-center items-end gap-6 md:gap-12 pb-16">
                    <div class="flex flex-col items-center gap-3 group cursor-pointer hover:-translate-y-2 transition-transform duration-300"><span class="text-5xl md:text-7xl text-[#d4af37] drop-shadow-[0_0_10px_rgba(212,175,55,0.3)]">♔</span><span class="text-[10px] tracking-[0.2em] uppercase text-white/30 group-hover:text-[#d4af37] transition-colors">King</span></div>
                    <div class="flex flex-col items-center gap-3 group cursor-pointer hover:-translate-y-2 transition-transform duration-300"><span class="text-5xl md:text-7xl text-white/90">♕</span><span class="text-[10px] tracking-[0.2em] uppercase text-white/30 group-hover:text-white transition-colors">Queen</span></div>
                    <div class="flex flex-col items-center gap-3 group cursor-pointer hover:-translate-y-2 transition-transform duration-300"><span class="text-5xl md:text-7xl text-white/80">♖</span><span class="text-[10px] tracking-[0.2em] uppercase text-white/30 group-hover:text-white transition-colors">Rook</span></div>
                    <div class="flex flex-col items-center gap-3 group cursor-pointer hover:-translate-y-2 transition-transform duration-300"><span class="text-5xl md:text-7xl text-white/80">♗</span><span class="text-[10px] tracking-[0.2em] uppercase text-white/30 group-hover:text-white transition-colors">Bishop</span></div>
                    <div class="flex flex-col items-center gap-3 group cursor-pointer hover:-translate-y-2 transition-transform duration-300"><span class="text-5xl md:text-7xl text-white/80">♘</span><span class="text-[10px] tracking-[0.2em] uppercase text-white/30 group-hover:text-white transition-colors">Knight</span></div>
                    <div class="flex flex-col items-center gap-3 group cursor-pointer hover:-translate-y-2 transition-transform duration-300"><span class="text-5xl md:text-7xl text-white/80">♙</span><span class="text-[10px] tracking-[0.2em] uppercase text-white/30 group-hover:text-white transition-colors">Pawn</span></div>
                </div>
                <!-- 2x8 INITIAL SETUP BOARD -->
                <div class="flex flex-col items-center gap-6 w-full px-4 mb-20">
                    <span class="text-[12px] tracking-[0.3em] uppercase text-white/40">Initial Formation</span>
                    <div class="relative p-3 border border-white/20 bg-[#151515] shadow-2xl">
                        <div class="grid grid-cols-8 grid-rows-2 w-full max-w-[900px] aspect-[8/2]">
                            <div class="bg-[#2a2a2a] flex items-center justify-center text-4xl md:text-6xl text-white/80">♙</div><div class="bg-[#111] flex items-center justify-center text-4xl md:text-6xl text-white/80">♙</div><div class="bg-[#2a2a2a] flex items-center justify-center text-4xl md:text-6xl text-white/80">♙</div><div class="bg-[#111] flex items-center justify-center text-4xl md:text-6xl text-white/80">♙</div><div class="bg-[#2a2a2a] flex items-center justify-center text-4xl md:text-6xl text-white/80">♙</div><div class="bg-[#111] flex items-center justify-center text-4xl md:text-6xl text-white/80">♙</div><div class="bg-[#2a2a2a] flex items-center justify-center text-4xl md:text-6xl text-white/80">♙</div><div class="bg-[#111] flex items-center justify-center text-4xl md:text-6xl text-white/80">♙</div>
                            <div class="bg-[#111] flex items-center justify-center text-4xl md:text-6xl text-white/90">♖</div><div class="bg-[#2a2a2a] flex items-center justify-center text-4xl md:text-6xl text-white/90">♘</div><div class="bg-[#111] flex items-center justify-center text-4xl md:text-6xl text-white/90">♗</div><div class="bg-[#2a2a2a] flex items-center justify-center text-4xl md:text-6xl text-white/90">♕</div><div class="bg-[#111] flex items-center justify-center text-4xl md:text-6xl text-[#d4af37]">♔</div><div class="bg-[#2a2a2a] flex items-center justify-center text-4xl md:text-6xl text-white/90">♗</div><div class="bg-[#111] flex items-center justify-center text-4xl md:text-6xl text-white/90">♘</div><div class="bg-[#2a2a2a] flex items-center justify-center text-4xl md:text-6xl text-white/90">♖</div>
                        </div>
                        <div class="absolute -top-1 -left-1 w-2 h-2 border-t border-l border-white/50"></div><div class="absolute -top-1 -right-1 w-2 h-2 border-t border-r border-white/50"></div><div class="absolute -bottom-1 -left-1 w-2 h-2 border-b border-l border-white/50"></div><div class="absolute -bottom-1 -right-1 w-2 h-2 border-b border-r border-white/50"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 2.5: CHESS RULES -->
    <section id="rules-section" class="relative py-32 bg-[#0a0a0a] overflow-hidden flex justify-center items-center min-h-screen">
        <div class="absolute top-20 right-[10%] w-28 h-28 border border-white/5 rotate-45 animate-pulse-glow z-0"></div>
        <div class="absolute bottom-20 left-[15%] w-16 h-16 border border-white/5 -rotate-12 animate-pulse-glow" style="animation-delay: 2s;"></div>
        <div class="relative w-[120vw] md:w-[110vw] bg-[#111] border border-white/10 shadow-[0_0_100px_rgba(0,0,0,0.5)] px-8 pt-20 pb-52 text-center z-10 rounded-[50%] flex flex-col items-center">
            <svg class="absolute inset-[-10px] w-[calc(100%+20px)] h-[calc(100%+20px)] pointer-events-none z-0 rounded-[50%]" style="overflow: visible;"><ellipse cx="50%" cy="50%" rx="50%" ry="50%" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="2" stroke-dasharray="10 15" class="animate-dash-flow" /></svg>
            <div class="absolute top-1/2 -translate-y-1/2 left-[2%] text-[15rem] md:text-[30rem] text-white opacity-80 drop-shadow-[0_0_20px_rgba(255,255,255,0.2)] transform -scale-x-100 select-none pointer-events-none">♘</div>
            <div class="absolute top-1/2 -translate-y-1/2 right-[2%] text-[15rem] md:text-[30rem] text-[#1a1a1a] opacity-90 drop-shadow-[0_0_5px_rgba(200,200,200,0.5)] select-none pointer-events-none">♞</div>
            <div class="max-w-5xl w-full fade-in-section relative z-10">
                <span class="block text-[#d4af37] text-xs tracking-[0.4em] mb-6 uppercase font-sans">The Code</span>
                <h3 class="text-4xl md:text-6xl font-serif text-white/90 mb-16 leading-tight">Chess Rules</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-16 gap-y-12 text-left font-serif">
                    <div class="space-y-10">
                        <div class="group"><h4 class="text-2xl text-white mb-3 group-hover:text-[#d4af37] transition-colors">I. The Initiative (선공)</h4><div class="h-[1px] w-full bg-white/10 mb-4 group-hover:w-full transition-all duration-700"></div><p class="text-white/50 leading-relaxed font-sans text-sm md:text-base break-keep">체스는 항상 <strong class="text-white">백(White)</strong>이 먼저 시작합니다. 흑과 백은 번갈아 가며 한 번에 하나의 수만 둘 수 있으며, 자신의 턴을 건너뛸 수 없습니다.</p></div>
                        <div class="group"><h4 class="text-2xl text-white mb-3 group-hover:text-[#d4af37] transition-colors">II. Victory (승리)</h4><div class="h-[1px] w-full bg-white/10 mb-4"></div><ul class="text-white/50 leading-relaxed font-sans text-sm md:text-base space-y-2 list-disc list-inside break-keep"><li><strong class="text-white/80">체크메이트 (Checkmate):</strong> 상대의 왕이 공격받고 있으며(체크), 어떠한 수로도 그 위협에서 벗어날 수 없을 때 승리합니다.</li><li><strong class="text-white/80">기권 (Resignation):</strong> 승산이 없다고 판단될 때 스스로 패배를 인정할 수 있습니다.</li></ul></div>
                        <div class="group"><h4 class="text-2xl text-white mb-3 group-hover:text-[#d4af37] transition-colors">III. Stalemate (무승부)</h4><div class="h-[1px] w-full bg-white/10 mb-4"></div><p class="text-white/50 leading-relaxed font-sans text-sm md:text-base break-keep">왕이 현재 체크 상태는 아니지만, 플레이어가 둘 수 있는 <strong class="text-white/80">합법적인 수가 하나도 없을 때</strong> 게임은 무승부(스테일메이트)로 종료됩니다. 기물 부족이나 3회 반복수일 때도 무승부가 됩니다.</p></div>
                    </div>
                    <div class="space-y-10">
                        <div class="group"><h4 class="text-2xl text-white mb-3 group-hover:text-[#d4af37] transition-colors">IV. Castling (캐슬링)</h4><div class="h-[1px] w-full bg-white/10 mb-4"></div><p class="text-white/50 leading-relaxed font-sans text-sm md:text-base break-keep">왕과 룩이 동시에 움직이는 유일한 특수 규칙입니다. 왕이 룩 방향으로 두 칸 이동하고, 룩이 왕을 넘어 그 옆자리로 이동합니다. 단, 왕과 룩이 한 번도 움직이지 않았어야 하며, 왕이 지나가는 길이 공격받지 않아야 합니다.</p></div>
                        <div class="group"><h4 class="text-2xl text-white mb-3 group-hover:text-[#d4af37] transition-colors">V. En Passant (앙파상)</h4><div class="h-[1px] w-full bg-white/10 mb-4"></div><p class="text-white/50 leading-relaxed font-sans text-sm md:text-base break-keep">상대의 폰이 처음에 두 칸 전진하여 내 폰의 바로 옆에 왔을 때, 마치 그 폰이 한 칸만 움직인 것처럼 간주하여 대각선으로 잡아낼 수 있습니다.</p></div>
                        <div class="group"><h4 class="text-2xl text-white mb-3 group-hover:text-[#d4af37] transition-colors">VI. Promotion (승급)</h4><div class="h-[1px] w-full bg-white/10 mb-4"></div><p class="text-white/50 leading-relaxed font-sans text-sm md:text-base break-keep">가장 약한 폰이라도 상대 진영의 끝까지 전진하면, <strong class="text-white/80">퀸, 룩, 비숍, 나이트</strong> 중 하나로 변신할 수 있습니다. 이것이 폰의 잠재력입니다.</p></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 3: THE PIECES -->
    <section id="pieces-section" class="relative py-20 bg-[#0a0a0a] border-t border-white/5 overflow-hidden">
        <div class="absolute top-10 left-[5%] w-20 h-20 border border-white/5 rotate-45 animate-pulse-glow z-0"></div>
        <div class="absolute bottom-10 right-[5%] w-24 h-24 border border-white/5 -rotate-12 animate-pulse-glow" style="animation-delay: 2.5s;"></div>
        <div class="max-w-7xl mx-auto px-6 relative z-10">
            <div class="text-center mb-16"><span class="text-xs tracking-[0.3em] text-[#d4af37]">THE PIECES</span><h3 class="text-4xl font-serif mt-4 text-white uppercase">Chess Piece</h3></div>
            <div class="carousel-container relative w-full h-[600px] flex items-center justify-center">
                <div id="carousel-track" class="carousel-track w-full h-full relative"></div>
                <button id="prevBtn" class="absolute left-[30%] md:left-[35%] top-1/2 -translate-y-1/2 z-20 p-3 text-white/50 hover:text-white transition-colors bg-black/20 hover:bg-black/50 rounded-full"><i data-lucide="chevron-left" width="32" height="32"></i></button>
                <button id="nextBtn" class="absolute right-[30%] md:right-[35%] top-1/2 -translate-y-1/2 z-20 p-3 text-white/50 hover:text-white transition-colors bg-black/20 hover:bg-black/50 rounded-full"><i data-lucide="chevron-right" width="32" height="32"></i></button>
            </div>
        </div>
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(255,255,255,0.03)_0%,transparent_70%)] pointer-events-none"></div>
    </section>

    <!-- SECTION 3.5: ADVANCED KNOWLEDGE -->
    <section id="info-section" class="relative py-40 bg-[#0a0a0a] overflow-hidden border-t border-white/5">
        <div class="absolute top-20 left-10 w-32 h-32 border border-white/5 rotate-45 animate-pulse-glow"></div>
        <div class="absolute bottom-40 right-20 w-48 h-48 border border-white/5 rotate-12 animate-pulse-glow" style="animation-delay: 1s;"></div>
        <div class="max-w-6xl mx-auto px-6 relative z-10">
            <div class="text-center mb-24 fade-in-section"><span class="text-xs tracking-[0.3em] text-[#d4af37]">DEEPER INSIGHT</span><h3 class="text-4xl md:text-6xl font-serif mt-4 text-white uppercase">Advanced Knowledge</h3><div class="w-20 h-[1px] bg-white/20 mx-auto mt-8"></div></div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
                <div class="group relative p-8 border border-white/10 bg-[#111] hover:bg-[#161616] transition-all duration-500 hover:-translate-y-2 fade-in-section"><div class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-[#d4af37] to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div><div class="text-[#d4af37] mb-6"><i data-lucide="book-open" width="40" height="40"></i></div><h4 class="text-2xl font-serif text-white mb-4">The Opening</h4><p class="text-white/50 leading-relaxed font-sans text-sm break-keep">체스의 시작 단계입니다. 중앙을 차지하고, 기물을 빠르게 전개하며, 왕을 안전하게 보호하는 것이 핵심 목표입니다.</p></div>
                <div class="group relative p-8 border border-white/10 bg-[#111] hover:bg-[#161616] transition-all duration-500 hover:-translate-y-2 fade-in-section" style="transition-delay: 0.2s;"><div class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-[#d4af37] to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div><div class="text-[#d4af37] mb-6"><i data-lucide="bar-chart-2" width="40" height="40"></i></div><h4 class="text-2xl font-serif text-white mb-4">Elo Rating</h4><p class="text-white/50 leading-relaxed font-sans text-sm break-keep">플레이어의 실력을 나타내는 숫자입니다. 1500점대는 평균, 2500점 이상은 그랜드마스터입니다.</p></div>
                <div class="group relative p-8 border border-white/10 bg-[#111] hover:bg-[#161616] transition-all duration-500 hover:-translate-y-2 fade-in-section" style="transition-delay: 0.4s;"><div class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-[#d4af37] to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div><div class="text-[#d4af37] mb-6"><i data-lucide="clock" width="40" height="40"></i></div><h4 class="text-2xl font-serif text-white mb-4">Time Controls</h4><p class="text-white/50 leading-relaxed font-sans text-sm break-keep">Bullet(1~2분), Blitz(3~5분), Rapid(10~60분), Classical(90분 이상) 등 다양한 방식이 존재합니다.</p></div>
            </div>
        </div>
    </section>

    <!-- SECTION 4: THE ARENA (GAME) -->
    <section id="game-section" class="min-h-screen py-20 flex flex-col justify-center items-center bg-[#050505] relative border-t border-white/5 z-20">
        <div class="absolute top-20 right-[5%] w-32 h-32 border border-white/5 rotate-90 animate-pulse-glow z-0"></div>
        <div class="absolute bottom-20 left-[10%] w-24 h-24 border border-white/5 -rotate-45 animate-pulse-glow" style="animation-delay: 3s;"></div>
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_#1a1a1a_0%,_#000000_100%)] opacity-50 pointer-events-none"></div>
        <div class="relative z-10 w-full max-w-7xl px-4 flex flex-col lg:flex-row gap-16 items-center justify-center">
            <div class="w-full lg:w-1/3 order-2 lg:order-1 space-y-8 text-center lg:text-left">
                <div><h2 class="text-5xl font-serif mb-2">The Arena</h2><p class="text-white/40 text-sm tracking-widest uppercase">Human vs Artificial Intelligence</p></div>
                <div class="border-l-2 border-[#d4af37] pl-6 py-4 bg-white/5 backdrop-blur-sm"><div id="status" class="text-2xl font-serif text-white mb-2">Ready to Start</div><div id="ai-indicator" class="flex items-center gap-2 text-xs tracking-widest text-[#d4af37] opacity-0 transition-opacity"><div class="w-2 h-2 bg-[#d4af37] rounded-full animate-pulse"></div>AI CALCULATING...</div></div>
                <div class="bg-white/5 p-6 rounded border border-white/10"><div class="flex justify-between text-xs tracking-widest text-white/60 mb-4"><span>INTELLIGENCE LEVEL</span><span id="diff-display" class="text-[#d4af37]">MEDIUM</span></div><input type="range" id="difficulty" min="1" max="3" value="2" class="w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-[#d4af37]"><div class="flex justify-between text-[10px] text-white/20 mt-2 uppercase"><span>Casual</span><span>Advanced</span></div></div>
                <div class="grid grid-cols-2 gap-4">
                    <button id="startBtn" class="py-4 border border-white/20 hover:bg-[#d4af37] hover:text-black hover:border-[#d4af37] transition-all text-xs tracking-[0.2em] uppercase">New Game</button>
                    <button id="flipBtn" class="py-4 border border-white/20 hover:bg-white/10 transition-all text-xs tracking-[0.2em] uppercase">Flip Board</button>
                    <button id="undoBtn" class="col-span-2 py-3 border border-white/10 text-white/50 hover:text-white hover:bg-white/5 transition-all text-xs tracking-[0.2em] uppercase">Undo Move</button>
                </div>
            </div>
            <div class="order-1 lg:order-2"><div id="myBoard" class="w-[340px] h-[340px] md:w-[500px] md:h-[500px] lg:w-[600px] lg:h-[600px] board-container"></div></div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="py-8 border-t border-white/5 text-center text-white/20 text-[10px] tracking-widest uppercase bg-[#050505] relative z-20"><p>&copy; 2025 AI.SW계열 엄휘석, 조재현</p></footer>

    <!-- LOGIC SCRIPT -->
    <script>
        lucide.createIcons();

        const observerOptions = { root: null, rootMargin: '0px', threshold: 0.1 };
        const observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        document.querySelectorAll('.fade-in-section').forEach(section => { observer.observe(section); });

        let baseRotation = 0;
        function animateRing() {
            const scrollRing = document.getElementById('scroll-ring');
            if (scrollRing) {
                baseRotation += 0.05;
                const scrollInfluence = window.scrollY * 0.15;
                const totalRotation = baseRotation + scrollInfluence;
                scrollRing.style.transform = `rotate(${totalRotation}deg)`;
            }
            requestAnimationFrame(animateRing);
        }
        animateRing();

        // CAROUSEL LOGIC
        const pieceData = [
            { name: "The King", role: "The Sovereign", desc: "가장 중요하지만 취약한 존재. 모든 방향으로 한 칸씩만 이동 가능합니다.", icon: "♔", moves: [[3,3],[3,4],[3,5],[4,3],[4,5],[5,3],[5,4],[5,5]], attacks: [[3,3],[3,4],[3,5],[4,3],[4,5],[5,3],[5,4],[5,5]] },
            { name: "The Queen", role: "The Commander", desc: "가장 강력한 기물. 직선과 대각선, 원하는 만큼 자유롭게 이동합니다.", icon: "♕", moves: generateLines([[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]]), attacks: generateLines([[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]]) },
            { name: "The Rook", role: "The Fortress", desc: "직선으로 거침없이 뻗어나가는 성벽. 후반에 강력한 공격수가 됩니다.", icon: "♖", moves: generateLines([[-1,0],[1,0],[0,-1],[0,1]]), attacks: generateLines([[-1,0],[1,0],[0,-1],[0,1]]) },
            { name: "The Bishop", role: "The Messenger", desc: "대각선의 지배자. 처음 놓인 칸의 색상을 벗어날 수 없습니다.", icon: "♗", moves: generateLines([[-1,-1],[-1,1],[1,-1],[1,1]]), attacks: generateLines([[-1,-1],[-1,1],[1,-1],[1,1]]) },
            { name: "The Knight", role: "The Cavalry", desc: "유일하게 다른 기물을 뛰어넘습니다. 'L'자 형태로 움직입니다.", icon: "♘", moves: [[2,3],[2,5],[3,2],[3,6],[5,2],[5,6],[6,3],[6,5]], attacks: [[2,3],[2,5],[3,2],[3,6],[5,2],[5,6],[6,3],[6,5]] },
            { name: "The Pawn", role: "The Infantry", desc: "전진만 가능하며 공격은 대각선으로만 합니다. 끝까지 가면 승급합니다.", icon: "♙", moves: [[3,4], [2,4]], attacks: [[3,3], [3,5]] }
        ];

        function generateLines(directions) {
            let squares = [];
            directions.forEach(dir => {
                for(let i=1; i<=4; i++) {
                    let r = 4 + dir[0]*i;
                    let c = 4 + dir[1]*i;
                    if(r >= 0 && r < 9 && c >= 0 && c < 9) squares.push([r,c]);
                }
            });
            return squares;
        }

        function renderMiniBoard(type, pieceIcon, highlights) {
            let html = `<div class="flex flex-col items-center gap-2 transform -translate-y-8"><div class="grid grid-cols-9 grid-rows-9 w-[160px] h-[160px] md:w-[220px] md:h-[220px] border border-white/20 shadow-lg bg-[#151515]">`;
            for(let r=0; r<9; r++) {
                for(let c=0; c<9; c++) {
                    let isCenter = (r===4 && c===4);
                    let isHighlight = highlights.some(h => h[0]===r && h[1]===c);
                    let bgClass = (r+c)%2===0 ? 'bg-[#2a2a2a]' : 'bg-[#111]';
                    let content = '';
                    if (isCenter) { content = `<span class="text-2xl md:text-3xl text-white drop-shadow-[0_0_5px_rgba(255,255,255,0.8)]">${pieceIcon}</span>`; bgClass = 'bg-white/10'; }
                    else if (isHighlight) { let color = type === 'move' ? 'bg-[#d4af37]/60' : 'bg-red-500/60'; html += `<div class="${bgClass} flex items-center justify-center relative"><div class="w-full h-full ${color} opacity-50"></div></div>`; continue; }
                    html += `<div class="${bgClass} flex items-center justify-center">${content}</div>`;
                }
            }
            html += `</div><span class="text-xs md:text-sm tracking-[0.2em] text-white/40 uppercase font-sans border-t border-white/10 pt-1 mt-3">${type === 'move' ? 'Move Range' : 'Attack Range'}</span></div>`;
            return html;
        }

        let currentPieceIndex = 0;
        const track = document.getElementById('carousel-track');
        function renderCarousel() {
            track.innerHTML = '';
            pieceData.forEach((piece, index) => {
                const isActive = index === currentPieceIndex;
                const slide = document.createElement('div');
                slide.className = `carousel-slide absolute top-0 left-0 w-full h-full flex flex-col items-center justify-center transition-all duration-700 ease-in-out ${isActive ? 'opacity-100 scale-100 z-10 translate-x-0' : 'opacity-0 scale-90 -z-10'}`;
                if (index < currentPieceIndex) slide.classList.add('-translate-x-full');
                if (index > currentPieceIndex) slide.classList.add('translate-x-full');
                const moveBoard = renderMiniBoard('move', piece.icon, piece.moves);
                const attackBoard = renderMiniBoard('attack', piece.icon, piece.attacks);
                slide.innerHTML = `<div class="flex flex-col items-center justify-center w-full h-full gap-8"><div class="flex flex-col md:flex-row items-center justify-center gap-20 md:gap-40 w-full"><div class="hidden md:block">${moveBoard}</div><div class="text-center w-[200px]"><div class="text-[8rem] md:text-[10rem] text-[#d4af37] drop-shadow-[0_0_30px_rgba(212,175,55,0.2)] leading-none">${piece.icon}</div></div><div class="hidden md:block">${attackBoard}</div><div class="flex gap-4 md:hidden">${moveBoard}${attackBoard}</div></div><div class="text-center max-w-xl px-4"><span class="text-xs tracking-[0.3em] uppercase text-white/40 block mb-2">${piece.role}</span><h4 class="text-3xl md:text-5xl font-serif text-white mb-4">${piece.name}</h4><p class="text-white/60 font-serif text-lg md:text-xl leading-relaxed break-keep">${piece.desc}</p></div></div>`;
                track.appendChild(slide);
            });
        }
        function nextSlide() { currentPieceIndex = (currentPieceIndex + 1) % pieceData.length; renderCarousel(); }
        function prevSlide() { currentPieceIndex = (currentPieceIndex - 1 + pieceData.length) % pieceData.length; renderCarousel(); }
        document.getElementById('nextBtn').addEventListener('click', nextSlide);
        document.getElementById('prevBtn').addEventListener('click', prevSlide);
        renderCarousel();

        // CHESS LOGIC
        var board = null;
        var game = new Chess();
        var $status = $('#status');
        var $aiIndicator = $('#ai-indicator');
        var searchDepth = 2; 
        var pieceValues = { p: 10, n: 30, b: 30, r: 50, q: 90, k: 900 };
        var playerColor = 'w'; 
        var selectedSquare = null;

        function removeHighlights() { $('.square-55d63').removeClass('highlight-dot highlight-ring highlight-selected'); }
        function highlightSquare(square) { $('.square-' + square).addClass('highlight-selected'); }
        function highlightMoves(moves) {
            for (var i = 0; i < moves.length; i++) {
                if (moves[i].flags.includes('c') || moves[i].flags.includes('e')) { $('.square-' + moves[i].to).addClass('highlight-ring'); }
                else { $('.square-' + moves[i].to).addClass('highlight-dot'); }
            }
        }

        function onSquareClick(square) {
            if (game.game_over()) return;
            if ((game.turn() === 'w' && playerColor !== 'w') || (game.turn() === 'b' && playerColor !== 'b')) return;

            var piece = game.get(square);
            if (piece && piece.color === game.turn()) {
                if (selectedSquare === square) { selectedSquare = null; removeHighlights(); return; }
                selectedSquare = square;
                removeHighlights();
                highlightSquare(square);
                var moves = game.moves({ square: square, verbose: true });
                highlightMoves(moves);
                return;
            }

            if (selectedSquare) {
                var move = game.move({ from: selectedSquare, to: square, promotion: 'q' });
                if (move) {
                    board.position(game.fen());
                    removeHighlights();
                    selectedSquare = null;
                    updateStatus();
                    startAI();
                } else {
                    selectedSquare = null;
                    removeHighlights();
                }
            }
        }

        function startAI() {
            if (!game.game_over()) {
                $aiIndicator.css('opacity', '1');
                window.setTimeout(makeBestMove, 250);
            }
        }

        function makeBestMove() {
            if(game.game_over()) return;
            var bestMove = getBestMove(game);
            game.move(bestMove);
            board.position(game.fen());
            updateStatus();
            $aiIndicator.css('opacity', '0');
        }

        function getBestMove(game) {
            var possibleMoves = game.moves();
            if (possibleMoves.length === 0) return;
            var bestMove = -9999;
            var bestMoveFound;
            possibleMoves.sort(() => Math.random() - 0.5);
            for (var i = 0; i < possibleMoves.length; i++) {
                var move = possibleMoves[i];
                game.move(move);
                var value = minimax(searchDepth, -10000, 10000, false);
                game.undo();
                if (value >= bestMove) { bestMove = value; bestMoveFound = move; }
            }
            return bestMoveFound;
        }

        function minimax(depth, alpha, beta, isMaximisingPlayer) {
            if (depth === 0) return -evaluateBoard(game.board());
            var newGameMoves = game.moves();
            if (isMaximisingPlayer) {
                var bestMove = -9999;
                for (var i = 0; i < newGameMoves.length; i++) {
                    game.move(newGameMoves[i]);
                    bestMove = Math.max(bestMove, minimax(depth - 1, alpha, beta, !isMaximisingPlayer));
                    game.undo();
                    alpha = Math.max(alpha, bestMove);
                    if (beta <= alpha) return bestMove;
                }
                return bestMove;
            } else {
                var bestMove = 9999;
                for (var i = 0; i < newGameMoves.length; i++) {
                    game.move(newGameMoves[i]);
                    bestMove = Math.min(bestMove, minimax(depth - 1, alpha, beta, !isMaximisingPlayer));
                    game.undo();
                    beta = Math.min(beta, bestMove);
                    if (beta <= alpha) return bestMove;
                }
                return bestMove;
            }
        }

        function evaluateBoard(board) {
            var totalEvaluation = 0;
            for (var i = 0; i < 8; i++) {
                for (var j = 0; j < 8; j++) {
                    totalEvaluation = totalEvaluation + getPieceValue(board[i][j], i, j);
                }
            }
            return totalEvaluation;
        }

        function getPieceValue(piece, x, y) {
            if (piece === null) return 0;
            var absoluteValue = pieceValues[piece.type];
            if(piece.type === 'p' || piece.type === 'n'){ if(x > 2 && x < 5 && y > 2 && y < 5) absoluteValue += 1; }
            return piece.color === 'w' ? absoluteValue : -absoluteValue;
        }

        function updateStatus () {
            var status = '';
            var moveColor = (game.turn() === 'b') ? 'Black' : 'White';
            if (game.in_checkmate()) { status = 'GAME OVER: ' + moveColor + ' is in Checkmate'; }
            else if (game.in_draw()) { status = 'GAME OVER: Draw'; }
            else { status = moveColor + "'s Turn"; if (game.in_check()) status += ' (CHECK!)'; }
            $status.text(status);
        }

        function toggleDropdown() {
            const dropdown = document.getElementById('dropdown-menu');
            const icon = document.getElementById('menu-icon');
            if (dropdown.classList.contains('visible')) { dropdown.classList.remove('visible'); icon.classList.remove('rotate-90'); } 
            else { dropdown.classList.add('visible'); icon.classList.add('rotate-90'); }
        }

        function scrollToSection(id) {
            const el = document.getElementById(id);
            if (el) { el.scrollIntoView({ behavior: 'smooth' }); }
        }

        var introBoard = null;
        var introGame = new Chess();
        var introTimer = null;
        var introMoves = ['e4', 'e5', 'Qh5', 'Nc6', 'Bc4', 'Nf6', 'Qxf7#']; 
        var currentMoveIndex = 0;

        function playIntroGame() {
            if (currentMoveIndex >= introMoves.length) {
                document.getElementById('checkmate-announcement').classList.add('visible');
                document.getElementById('introBoard').classList.add('shake-effect');
                setTimeout(() => {
                    const overlay = document.getElementById('intro-overlay');
                    const body = document.getElementById('main-body');
                    overlay.style.opacity = '0';
                    setTimeout(() => { overlay.classList.add('hidden'); body.classList.remove('overflow-hidden'); }, 1500);
                }, 2000);
                return;
            }

            var moveDetails = introGame.move(introMoves[currentMoveIndex]);
            var moveString = moveDetails.from + '-' + moveDetails.to;
            
            introBoard.move(moveString);
            currentMoveIndex++;
            
            introTimer = setTimeout(playIntroGame, 1200);
        }

        function skipIntro() {
            clearTimeout(introTimer);
            const overlay = document.getElementById('intro-overlay');
            const body = document.getElementById('main-body');
            overlay.style.opacity = '0';
            setTimeout(() => { overlay.classList.add('hidden'); body.classList.remove('overflow-hidden'); }, 1000);
        }

        $(document).ready(function() {
            var config = {
                draggable: false, 
                position: 'start',
                pieceTheme: 'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png'
            };
            board = Chessboard('myBoard', config);
            $('#myBoard').on('click', '.square-55d63', function() { var square = $(this).data('square'); onSquareClick(square); });
            updateStatus();

            $('#difficulty').on('input', function() { var val = parseInt($(this).val()); searchDepth = val; var labels = ['EASY', 'MEDIUM', 'HARD']; $('#diff-display').text(labels[val-1]); });
            $('#startBtn').click(function() { game.reset(); board.start(); playerColor = board.orientation() === 'white' ? 'w' : 'b'; selectedSquare = null; removeHighlights(); if(playerColor === 'b') { startAI(); } updateStatus(); });
            $('#flipBtn').click(function() { board.flip(); playerColor = playerColor === 'w' ? 'b' : 'w'; selectedSquare = null; removeHighlights(); if (game.turn() !== playerColor) { startAI(); } });
            $('#undoBtn').click(function() { game.undo(); game.undo(); board.position(game.fen()); selectedSquare = null; removeHighlights(); updateStatus(); });
            
            $(window).resize(board.resize);

            // Intro Init with slower move speed for visibility
            var introConfig = { position: 'start', showNotation: false, draggable: false, moveSpeed: 800, pieceTheme: 'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png' };
            introBoard = Chessboard('introBoard', introConfig);
            setTimeout(playIntroGame, 1000);
        });
    </script>
</body>
</html>